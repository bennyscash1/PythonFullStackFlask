<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>API Test</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 20px;
        }
        h1 {
            color: #0056b3;
        }
        form {
            background: #fff;
            padding: 20px;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="text"], select, textarea {
            width: calc(50% - 22px); /* Changed width to 50% */
            padding: 8px; /* Changed padding to 8px */
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-size: 14px; /* Adjusted font size */
        }
        .field-pair, .field-single, .field-container {
            margin-bottom: 15px;
        }
        .field-pair label, .field-single label {
            margin-right: 10px;
        }
        .key-field {
            background-color: #f0f0f0;
        }
        .value-field {
            background-color: #eafaea;
        }
        button {
            background-color: #0056b3;
            color: #fff;
            padding: 10px 20px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-right: 10px;
        }
        button:hover {
            background-color: #004494;
        }
        .remove-button {
            background-color: #ff0000;
        }
        .remove-button:hover {
            background-color: #cc0000;
        }
        .submit-button {
            background-color: #0056b3;
            color: #fff;
            font-weight: bold;
            font-size: 1.2em;
        }
        .submit-button:hover {
            background-color: #004494;
        }
        .hidden {
            display: none;
        }
    </style>
    <script>
        function handleRequestTypeChange() {
            var requestType = document.getElementById('requestType').value;
            var postFieldsContainer = document.getElementById('postFieldsContainer');
            var headersField = document.getElementById('headersField');
            var assertStatusField = document.getElementById('assertStatusField');

            if (requestType === 'GET') {
                postFieldsContainer.classList.add('hidden');
            } else {
                postFieldsContainer.classList.remove('hidden');
            }
            headersField.classList.remove('hidden');
            assertStatusField.classList.remove('hidden');
        }

        function addPostKeyField() {
            var postKeysContainer = document.getElementById('postKeysContainer');
            
            // Create input for key
            var keyInput = document.createElement('input');
            keyInput.type = 'text';
            keyInput.name = 'postKey[]';
            keyInput.placeholder = 'Post Key';
            keyInput.className = 'key-field';
            postKeysContainer.appendChild(keyInput);
            
            // Create input for value
            var valueInput = document.createElement('input');
            valueInput.type = 'text';
            valueInput.name = 'postValue[]';
            valueInput.placeholder = 'Post Value';
            valueInput.className = 'value-field';
            postKeysContainer.appendChild(valueInput);
            
            // Create remove button
            var removeButton = document.createElement('button');
            removeButton.type = 'button';
            removeButton.className = 'remove-button';
            removeButton.textContent = 'Remove';
            removeButton.onclick = function() {
                postKeysContainer.removeChild(keyInput);
                postKeysContainer.removeChild(valueInput);
                postKeysContainer.removeChild(removeButton);
            };
            postKeysContainer.appendChild(removeButton);

            postKeysContainer.appendChild(document.createElement('br'));
        }
    </script>
</head>
<body>
    <h1>API Test</h1>
    <form method="post">
        <label for="apiEndpoint">API Endpoint:</label>
        <input type="text" id="apiEndpoint" name="apiEndpoint" required><br><br>

        <label for="requestType">Request Type:</label>
        <select id="requestType" name="requestType" onchange="handleRequestTypeChange()" required>
            <option value="GET">GET</option>
            <option value="POST">POST</option>
        </select><br><br>

        <div id="headersField" class="field-container">
            <label for="headers">Headers (Token):</label>
            <input type="text" id="headers" name="headers"><br><br>
        </div>

        <div id="postFieldsContainer" class="hidden">
            <div id="postKeysContainer" class="field-container">
                <label>Post Keys:</label>
                <button type="button" onclick="addPostKeyField()">Add Post Key</button><br>
            </div>
        </div>

        <div id="assertStatusField" class="field-container">
            <label for="assertStatus">Assert HTTP Status:</label>
            <input type="text" id="assertStatus" name="assertStatus"><br><br>
        </div>

        <button type="submit" class="submit-button">Run Test</button>
    </form>

    {% if result %}
        <div id="test-result">
            <h2>Test Results</h2>
            {{ result|safe }}
        </div>
    {% endif %}
</body>
</html>
